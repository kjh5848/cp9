import { ProductResult } from '../types';

/**
 * 더미 리서치 결과 데이터
 * 백엔드 API 연동 전까지 사용할 테스트 데이터
 */
export const DUMMY_RESEARCH_RESULTS: ProductResult[] = [
  {
    "product_name": "베이직스 2024 베이직북 14 N-시리즈",
    "brand": "베이직스",
    "category": "가전디지털",
    "model_or_variant": "베이직북 14 N-시리즈",
    "price_exact": 388000,
    "currency": "KRW",
    "seller_or_store": "베이직스 공식몰",
    "deeplink_or_product_url": "https://basic-s.com/compare.html",
    "coupang_price": undefined,
    "specs": {
      "main": [
        "Intel N95 CPU",
        "RAM 8GB (16GB 옵션)",
        "SSD 256GB (512GB 옵션)",
        "14.1형 IPS FHD 디스플레이 (1920x1080)",
        "배터리 3,400mAh",
        "Windows 11 Home (미포함 선택 가능)"
      ],
      "attributes": [
        {"name": "포트", "value": "USB 3.0 x2, Mini HDMI, Type-C, Micro SD, 헤드폰 잭, 충전포트"},
        {"name": "카메라", "value": "전면 2MP"},
        {"name": "부팅속도", "value": "약 12초"}
      ],
      "size_or_weight": "1.35kg",
      "options": ["RAM 8GB/16GB", "SSD 256GB/512GB", "Windows 포함/미포함"],
      "included_items": ["노트북 본체", "충전기"]
    },
    "reviews": {
      "rating_avg": 4.3,
      "review_count": 41,
      "summary_positive": [
        "가성비가 뛰어나다",
        "휴대성이 좋다",
        "IPS 패널로 시야각과 색감이 우수하다"
      ],
      "summary_negative": [
        "터치패드 감도가 아쉽다",
        "성능이 고사양 작업에는 부족하다"
      ],
      "notable_reviews": [
        {"source": "에누리", "quote": "휴대성이 괜찮고 저렴한 티가 나지 않아 좋았습니다.", "url": "https://www.enuri.com/knowcom/detail.jsp?kbno=3463094"},
        {"source": "다나와", "quote": "부팅속도가 빠르고 기본 사무용으로 적합합니다.", "url": "https://prod.danawa.com/info/?pcode=17597009"}
      ]
    },
    "sources": [
      "https://basic-s.com/compare.html",
      "https://www.enuri.com/knowcom/detail.jsp?kbno=3463094",
      "https://prod.danawa.com/info/?pcode=17597009"
    ],
    "captured_at": "2025-08-23",
    "status": "success"
  },
  {
    "product_name": "레노버 2025 아이디어패드 1 15IJL7 15.6 셀러론 N5100",
    "brand": "레노버",
    "category": "가전디지털",
    "model_or_variant": "IdeaPad 1 15IJL7 N5100",
    "price_exact": 339000,
    "currency": "KRW",
    "seller_or_store": "",
    "deeplink_or_product_url": "",
    "coupang_price": undefined,
    "specs": {
      "main": [],
      "attributes": [],
      "size_or_weight": "",
      "options": [],
      "included_items": []
    },
    "reviews": {
      "rating_avg": 0,
      "review_count": 0,
      "summary_positive": [],
      "summary_negative": [],
      "notable_reviews": []
    },
    "sources": [],
    "status": "insufficient_sources",
    "missing_fields": [
      "reviews.rating_avg",
      "reviews.review_count",
      "specs.main",
      "specs.attributes",
      "specs.size_or_weight",
      "specs.options",
      "specs.included_items",
      "seller_or_store",
      "deeplink_or_product_url"
    ],
    "suggested_queries": [
      "레노버 IdeaPad 1 15IJL7 공식 모델명 리뷰",
      "리테일러 리뷰탭/전문매체 리뷰 검색어: '레노버 아이디어패드 1 N5100 리뷰'"
    ],
    "captured_at": "2025-08-23"
  },
  {
    "product_name": "베이직스 2024 베이직북14 인텔 셀러론 N시리즈",
    "brand": "베이직스",
    "category": "가전디지털",
    "model_or_variant": "베이직북14 인텔 셀러론 N시리즈",
    "price_exact": 398000,
    "currency": "KRW",
    "seller_or_store": "베이직스 공식몰",
    "deeplink_or_product_url": "https://basic-s.com/compare.html",
    "coupang_price": undefined,
    "specs": {
      "main": [
        "Intel N5095/N5100 CPU",
        "RAM 8GB (16GB 옵션)",
        "SSD 256GB (512GB 옵션)",
        "14.1형 IPS FHD 디스플레이 (1920x1080)",
        "배터리 3,400mAh",
        "Windows 11 Home (미포함 선택 가능)"
      ],
      "attributes": [
        {"name": "포트", "value": "USB 3.0 x2, Mini HDMI, Type-C, Micro SD, 헤드폰 잭, 충전포트"},
        {"name": "카메라", "value": "전면 2MP"},
        {"name": "부팅속도", "value": "약 12초"}
      ],
      "size_or_weight": "1.35kg",
      "options": ["RAM 8GB/16GB", "SSD 256GB/512GB", "Windows 포함/미포함"],
      "included_items": ["노트북 본체", "충전기"]
    },
    "reviews": {
      "rating_avg": 4.3,
      "review_count": 41,
      "summary_positive": [
        "가성비가 뛰어나다",
        "휴대성이 좋다",
        "IPS 패널로 시야각과 색감이 우수하다"
      ],
      "summary_negative": [
        "터치패드 감도가 아쉽다",
        "성능이 고사양 작업에는 부족하다"
      ],
      "notable_reviews": [
        {"source": "에누리", "quote": "휴대성이 괜찮고 저렴한 티가 나지 않아 좋았습니다.", "url": "https://www.enuri.com/knowcom/detail.jsp?kbno=3463094"},
        {"source": "다나와", "quote": "부팅속도가 빠르고 기본 사무용으로 적합합니다.", "url": "https://prod.danawa.com/info/?pcode=17597009"}
      ]
    },
    "sources": [
      "https://basic-s.com/compare.html",
      "https://www.enuri.com/knowcom/detail.jsp?kbno=3463094",
      "https://prod.danawa.com/info/?pcode=17597009"
    ],
    "captured_at": "2025-08-23",
    "status": "success"
  },
  {
    "product_name": "LG 울트라PC 15U560 6세대 i5 지포스940M 15.6인치 윈도우10 8GB",
    "brand": "LG전자",
    "category": "가전디지털",
    "model_or_variant": "15U560 6세대 i5 지포스940M",
    "price_exact": 398000,
    "currency": "KRW",
    "seller_or_store": "",
    "deeplink_or_product_url": "",
    "coupang_price": undefined,
    "specs": {
      "main": [],
      "attributes": [],
      "size_or_weight": "",
      "options": [],
      "included_items": []
    },
    "reviews": {
      "rating_avg": 0,
      "review_count": 0,
      "summary_positive": [],
      "summary_negative": [],
      "notable_reviews": []
    },
    "sources": [],
    "status": "insufficient_sources",
    "missing_fields": [
      "reviews.rating_avg",
      "reviews.review_count",
      "specs.main",
      "specs.attributes",
      "specs.size_or_weight",
      "specs.options",
      "specs.included_items",
      "seller_or_store",
      "deeplink_or_product_url"
    ],
    "suggested_queries": [
      "LG 울트라PC 15U560 공식 모델명 리뷰",
      "리테일러 리뷰탭/전문매체 리뷰 검색어: 'LG 울트라PC 15U560 리뷰'"
    ],
    "captured_at": "2025-08-23"
  },
  {
    "product_name": "에이수스 2024 비보북 Go 15 15.6 라이젠5 라이젠 7000 시리즈 AMD Radeon",
    "brand": "ASUS",
    "category": "가전디지털",
    "model_or_variant": "VivoBook Go 15 E1504FA-BQ476",
    "price_exact": 589000,
    "currency": "KRW",
    "seller_or_store": "",
    "deeplink_or_product_url": "",
    "coupang_price": undefined,
    "specs": {
      "main": [],
      "attributes": [],
      "size_or_weight": "",
      "options": [],
      "included_items": []
    },
    "reviews": {
      "rating_avg": 0,
      "review_count": 0,
      "summary_positive": [],
      "summary_negative": [],
      "notable_reviews": []
    },
    "sources": [],
    "status": "insufficient_sources",
    "missing_fields": [
      "reviews.rating_avg",
      "reviews.review_count",
      "specs.main",
      "specs.attributes",
      "specs.size_or_weight",
      "specs.options",
      "specs.included_items",
      "seller_or_store",
      "deeplink_or_product_url"
    ],
    "suggested_queries": [
      "ASUS VivoBook Go 15 E1504FA-BQ476 공식 모델명 리뷰",
      "리테일러 리뷰탭/전문매체 리뷰 검색어: 'ASUS 비보북 Go 15 라이젠5 리뷰'"
    ],
    "captured_at": "2025-08-23"
  }
];

/**
 * 쿠팡 제품과 리서치 결과를 매칭하는 유틸리티 함수
 */
export const matchCoupangToResearch = (productName: string): ProductResult | null => {
  // 키워드 기반 매칭
  const keywords = ['베이직스', '레노버', 'LG', '에이수스', 'ASUS'];
  
  for (const keyword of keywords) {
    if (productName.includes(keyword)) {
      const result = DUMMY_RESEARCH_RESULTS.find(r => 
        r.brand.toLowerCase().includes(keyword.toLowerCase()) ||
        r.product_name.toLowerCase().includes(keyword.toLowerCase())
      );
      
      if (result) {
        return result;
      }
    }
  }
  
  // 제품명 부분 매칭
  return DUMMY_RESEARCH_RESULTS.find(r => {
    const productWords = productName.toLowerCase().split(' ');
    const researchWords = r.product_name.toLowerCase().split(' ');
    
    // 두 개 이상의 단어가 일치하면 매칭
    const matchCount = productWords.filter(word => 
      researchWords.some(rWord => rWord.includes(word) || word.includes(rWord))
    ).length;
    
    return matchCount >= 2;
  }) || null;
};

/**
 * 더미 데이터에서 성공한 리서치 결과만 필터링
 */
export const getSuccessfulResults = (): ProductResult[] => {
  return DUMMY_RESEARCH_RESULTS.filter(result => result.status === 'success');
};

/**
 * 더미 데이터에서 실패한 리서치 결과만 필터링
 */
export const getFailedResults = (): ProductResult[] => {
  return DUMMY_RESEARCH_RESULTS.filter(result => result.status !== 'success');
};